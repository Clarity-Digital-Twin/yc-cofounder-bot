Scope and Requirements

In‑Scope (MVP: Semi‑Auto Browser Mode)
- Autonomous navigation with HIL approval gates:
  - Open target URL (WEBSITE_LINK.MD), manual login, navigate list, click “View profile”.
  - Read profile, produce structured decision JSON: {decision YES/NO, rationale, draft, extracted:{name,tags}}.
  - Apply a deterministic scoring rubric (thresholded) before YES; LLM provides rationale/draft.
  - Populate right‑panel message box; on approval, enforce `quota_guard(limit=N)` and click “Send”, else “Skip”.
- Streamlit UI: criteria, template, quota, “N remaining”, approve/send/skip, export summary.
- Cross‑run dedupe (SQLite) using normalized profile hash; session log of actions.
- Progress cursor to resume after crash/STOP (current list index/profile URL).
- JSONL event log with timestamps, decisions, send status, and prompt version.
- Default assets: load WEBSITE_LINK.MD for URL; MATCH_MESSAGE_TEMPLATE.MD for template.

Out‑of‑Scope (MVP)
- Automated login, CAPTCHA solving, or device verification.
- Background daemon/scheduler; runs are manual.
- External datastore integrations (CRM, Google Sheets, etc.).

Functional Requirements
- Decisioning: structured JSON output validated via schema; deterministic rubric gate; rationale and draft generated by the model.
- Messaging: render a DM via your template; clamp to safety rules and max length post‑slotting; strip unknown placeholders.
- Safety: require `quota_guard` before send; Big Red STOP; per‑run max steps and per‑response max tokens; prompt‑injection defense (treat profile text as untrusted; ignore instructions inside it).
- Human‑in‑the‑loop: visible approvals; headful browser; easy pause/abort.
- Observability: JSONL event log + export; optional screenshot on send; cost estimate per run; per‑response token counts (`tokens_in`, `tokens_out`) and cost estimate.
- Idempotence: cross‑run dedupe via SQLite; session‑level “seen”.
- UI specifics: use visible text for actions (“View profile”, “Send”, “Skip”); retries with small jitter; fallback to role/ARIA selectors when labels change (icons).
- Privacy: optional PII redaction in logs/screenshots (emails, phones, handles) via toggle.

Non‑Functional Requirements
- Reliability: resilient to minor UI changes; supervised.
- Compliance: respect site ToS; rate‑limit and keep batch small.
- Security: keep secrets local; the model never sees credentials.
- Cost: token use bounded by small batch runs and short prompts.
- Portability: runs on macOS/Windows/Linux with Chromium.

Assumptions
- Operator holds an OpenAI API key with access to the Computer Use preview model.
- Manual login is acceptable; session persists for the run.
- The site’s UI is navigable via visible text actions and screenshots.
- HIL paste mode remains available as a diagnostic view.

Open Questions (to confirm)
- Preferred rubric weights and initial threshold for YES.
- Safety phrases/ban-list for messaging; max length policy.
- Daily/weekly quota and pacing between messages.
- Whether to enable Shadow Mode initially (no sends; compute precision/recall against your judgment).
 - Redaction default (on/off) and which PII patterns to mask.
